* Checking for deprecated package usage... OK
* Checking for remote package usage... OK
* Checking for 'LazyData: true' usage...
* NOTE: 'LazyData:' in the 'DESCRIPTION' should be set to false or removed
* Checking version number... OK
* Checking for version number mismatch... OK
* Checking version number validity... OK
* Checking R version dependency...
* NOTE: Update R version dependency from 2.10 to 4.3.0.
* Checking package size... OK
* Checking individual file sizes... OK
* Checking biocViews... OK
* Checking that biocViews are present...
* ERROR: No biocViews terms found.
* Checking build system compatibility... OK
* Checking for blank lines in DESCRIPTION... OK
* Checking if DESCRIPTION is well formatted... OK
* Checking for proper Description: field...
* NOTE: The Description field in the DESCRIPTION is made up by less than 3
sentences. Please consider expanding this field, and structure it as a full
paragraph
* Checking for whitespace in DESCRIPTION field names... OK
* Checking that Package field matches directory/tarball name... OK
* Checking for Version field... OK
* Checking for valid maintainer...
* ERROR: Remove Maintainer field. Use Authors@R [cre] designation.
* Checking License: for restrictive use... OK
* Checking for recommeded fields in DESCRIPTION...
* NOTE: Provide 'URL', 'BugReports' field(s) in DESCRIPTION
* Checking for pinned package versions... OK
* Checking DESCRIPTION/NAMESPACE consistency...
* WARNING: Import stats, utils in DESCRIPTION as well as NAMESPACE.
* Checking .Rbuildignore... OK
* Checking for stray BiocCheck output folders... OK
* Checking vignette directory...
* NOTE:  'sessionInfo' not found in vignette(s)
Missing from file(s):
vignettes/STEAMcpp.Rmd
* Checking package installation calls in R code... OK
* Checking for library/require of STEAMcpp... OK
* Checking coding practice...
* NOTE:  Avoid sapply(); use vapply()
Found in files:
R/get_deltas.R (line 18, column 17)
R/get_g.R (line 36, column 16)
* NOTE:  Avoid 1:...; use seq_len() or seq_along()
Found in files:
get_corr_chr.R (line 32, column 47)
get_corr_chr.R (line 70, column 12)
get_deltas.R (line 18, column 24)
get_g.R (line 30, column 14)
get_g.R (line 32, column 74)
get_thresh_analytic.R (line 29, column 23)
* NOTE:  Avoid 'cat' and 'print' outside of 'show' methods
Found in files:
cat() in R/get_corr_chr.R (line 86, column 41)
cat() in R/get_L.R (line 31, column  7)
cat() in R/get_thresh_analytic.R (line 42, column  5)
cat() in R/get_thresh_simstat.R (line 54, column  5)
cat() in R/get_thresh_simstat.R (line 65, column  5)
* NOTE:  Avoid the use of 'paste' in condition signals
Found in files:
R/helper_functions.R (line 5, column 13)
* WARNING:  Avoid T/F variables; If logical, use TRUE/FALSE 
Found 9 times:
T in R/get_L.R (line 23, column 23)
F in R/get_thresh_analytic.R (line 37, column 31)
T in R/get_thresh_simstat.R (line 34, column 41)
F in R/get_thresh_simstat.R (line 62, column 45)
F in R/get_thresh_simstat.R (line 63, column 47)
F in R/helper_functions.R (line 28, column 76)
F in R/helper_functions.R (line 29, column 76)
F in R/helper_functions.R (line 30, column 76)
F in R/run_unc_nls.R (line 24, column 44)
* Checking parsed R code in R directory, examples, vignettes... OK
* Checking function lengths...
* NOTE: The recommended function length is 50 lines or less. There is 1 function greater than 50 lines.
The longest 5 functions are:
get_corr_chr() (R/get_corr_chr.R): 69 lines
* Checking man page documentation...
* WARNING: Empty or missing \value sections found in man pages.
Found in files:
man/example_ab.Rd
man/example_corr_K3.Rd
man/example_corr.Rd
man/example_L.Rd
man/example_map.Rd
man/example_props_K3.Rd
man/example_props.Rd
* ERROR: At least 80% of man pages documenting exported objects must have runnable examples.
The following pages do not:
combine_corr_chr.Rd
get_corr_chr.Rd
* Checking package NEWS...
* NOTE: Consider adding a NEWS file, so your package news will be included in Bioconductor release announcements.
* Checking unit tests...
* NOTE: Consider adding unit tests. We strongly encourage them. See
  https://contributions.bioconductor.org/tests.html
* Checking skip_on_bioc() in tests... OK
* Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
* NOTE: Consider shorter lines; 116 lines (8%) are > 80 characters long.
First few lines:
R/combine_corr_chr.R#L8 #' @param cor.list list of data tables,  ...
R/combine_corr_chr.R#L10 #' @return A data table with the average ...
R/combine_corr_chr.R#L11 #' estimating the number of generations  ...
R/combine_corr_chr.R#L17 #' @seealso \code{\link[STEAMcpp]{get_g} ...
R/combine_corr_chr.R#L25   avgs <- snps.df[,list(mean(corr_11),me ...
R/combine_corr_chr.R#L38                        times = c('1_1',' ...
R/example_corr_K3.R#L18 #'   \code{thetas <- seq(0, 0.5, length  ...
R/example_corr.R#L18 #'   \code{thetas <- seq(0, 0.5, length  ...
R/example_map.R#L13 #'   \code{data.frame(cM = rep(seq(0.2,  ...
R/example_props_K3.R#L14 #'   \code{library(gtools); example_prop ...
R/example_props.R#L14 #'   \code{example_props <- data.frame(p ...
R/get_corr_chr.R#L8 #' @param binsize size (in cM) of distan ...
R/get_corr_chr.R#L10 #' @param pop1.gds name of GDS file stor ...
R/get_corr_chr.R#L11 #' @param pop2.gds name of GDS file stor ...
R/get_corr_chr.R#L12 #' @param pop3.gds name of GDS file stor ...
R/get_corr_chr.R#L16 #' @return A data table with the observe ...
R/get_corr_chr.R#L24 #' @seealso \code{\link[STEAMcpp]{get_g} ...
R/get_corr_chr.R#L27 get_corr_chr <- function(chrom, binsize  ...
R/get_corr_chr.R#L86     if(i %% 100 == 0 & verbose == TRUE)  ...
R/get_deltas.R#L6 #' @param map data frame with m rows and ...
R/get_g.R#L7 #' @param lacorr local ancestry correlat ...
R/get_g.R#L12 #' @return A single number indicating th ...
R/get_L.R#L6 #' @param ep vector of length K (K = no. ...
R/get_sigma_ij.R#L7 #' @param ep1,ep2 expected (average) adm ...
R/get_sigma.R#L7 #' @param ep vector of length K (K = no. ...
R/get_thresh_analytic.R#L1 #' Significance Threshold Estimation for ...
R/get_thresh_analytic.R#L3 #' Compute genome-wide significance (tes ...
R/get_thresh_analytic.R#L4 #' mapping using analytic approximation  ...
R/get_thresh_analytic.R#L8 #' @param map data frame with m rows and ...
R/get_thresh_analytic.R#L10 #' @param type the type of threshold tha ...
R/get_thresh_analytic.R#L11 #' @param searchint the range of test st ...
R/get_thresh_analytic.R#L13 #' @return A single number indicating th ...
R/get_thresh_analytic.R#L17 #' get_thresh_analytic(g = 6, map = exam ...
R/get_thresh_analytic.R#L25 get_thresh_analytic <- function(g, map,  ...
R/get_thresh_analytic.R#L34   Z <- uniroot(OU_approx, interval = sea ...
R/get_thresh_simstat.R#L1 #' Significance Threshold Estimation for ...
R/get_thresh_simstat.R#L3 #' Compute genome-wide significance (tes ...
R/get_thresh_simstat.R#L4 #' mapping by simulating admixture mappi ...
R/get_thresh_simstat.R#L9 #' @param map data frame with m rows and ...
R/get_thresh_simstat.R#L10 #' @param props data frame (n x K) of ad ...
R/get_thresh_simstat.R#L11 #' @param nreps the number of repetition ...
R/get_thresh_simstat.R#L13 #' @param type the type of threshold tha ...
R/get_thresh_simstat.R#L14 #' @param method the method used to simu ...
R/get_thresh_simstat.R#L16 #' @return A single number indicating th ...
R/get_thresh_simstat.R#L19 #' get_thresh_simstat(g = 6, map = examp ...
R/get_thresh_simstat.R#L20 #' get_thresh_simstat(g = 6, map = examp ...
R/get_thresh_simstat.R#L26 get_thresh_simstat <- function(g, map, p ...
R/get_thresh_simstat.R#L41     max_stats <- replicate(nreps, simsta ...
R/get_thresh_simstat.R#L43     max_stats <- replicate(nreps, simsta ...
R/get_thresh_simstat.R#L51     z_ci <- quantile(bootstrap::bootstra ...
R/globals.R#L1 utils::globalVariables(c("bin","cM","chr ...
R/nu.R#L3 #' Helper function for Ornstein Uhlenbec ...
R/OU_approx.R#L15 #' @return A single number indicating th ...
R/run_unc_nls.R#L7 #' @param lacorr local ancestry correlat ...
R/run_unc_nls.R#L13 #' @return A single number indicating th ...
R/simstat_once.R#L9 #' @param as vector of scalars (length m ...
R/simstat_once.R#L10 #' @param bs vector of scalars (length m ...
R/simstat_once.R#L11 #' @param L matrix (K x K-1) that is squ ...
R/simstat_once.R#L16 #' simstat_once(m = 2, K = 2, as = examp ...
man/combine_corr_chr.Rd#L10 \item{cor.list}{list of data tables, one ...
man/combine_corr_chr.Rd#L14 estimating the number of generations sin ...
man/example_corr_K3.Rd#L15   \code{thetas <- seq(0, 0.5, length = 5 ...
man/example_corr.Rd#L15   \code{thetas <- seq(0, 0.5, length = 5 ...
man/example_map.Rd#L15   \code{data.frame(cM = rep(seq(0.2, 160 ...
man/example_props_K3.Rd#L15   \code{library(gtools); example_props_K ...
man/example_props.Rd#L15   \code{example_props <- data.frame(pop1 ...
man/get_corr_chr.Rd#L20 \item{binsize}{size (in cM) of distance  ...
man/get_corr_chr.Rd#L24 \item{pop1.gds}{name of GDS file storing ...
man/get_corr_chr.Rd#L26 \item{pop2.gds}{name of GDS file storing ...
man/get_corr_chr.Rd#L28 \item{pop3.gds}{name of GDS file storing ...
man/get_corr_chr.Rd#L33 A data table with the observed correlati ...
man/get_deltas.Rd#L10 \item{map}{data frame with m rows and 2  ...
man/get_g.Rd#L10 \item{lacorr}{local ancestry correlation ...
man/get_L.Rd#L10 \item{ep}{vector of length K (K = no. an ...
man/get_sigma_ij.Rd#L10 \item{ep1, ep2}{expected (average) admix ...
man/get_sigma.Rd#L10 \item{ep}{vector of length K (K = no. an ...
man/get_thresh_analytic.Rd#L5 \title{Significance Threshold Estimation ...
man/get_thresh_analytic.Rd#L18 \item{map}{data frame with m rows and at ...
man/get_thresh_analytic.Rd#L22 \item{type}{the type of threshold that s ...
man/get_thresh_analytic.Rd#L24 \item{searchint}{the range of test stati ...
man/get_thresh_analytic.Rd#L27 A single number indicating the estimated ...
man/get_thresh_analytic.Rd#L30 Compute genome-wide significance (test s ...
man/get_thresh_analytic.Rd#L31 mapping using analytic approximation to  ...
man/get_thresh_analytic.Rd#L36 get_thresh_analytic(g = 6, map = example ...
man/get_thresh_simstat.Rd#L5 \title{Significance Threshold Estimation ...
man/get_thresh_simstat.Rd#L20 \item{map}{data frame with m rows and at ...
man/get_thresh_simstat.Rd#L22 \item{props}{data frame (n x K) of admix ...
man/get_thresh_simstat.Rd#L24 \item{nreps}{the number of repetitions f ...
man/get_thresh_simstat.Rd#L28 \item{type}{the type of threshold that s ...
man/get_thresh_simstat.Rd#L30 \item{method}{the method used to simulat ...
man/get_thresh_simstat.Rd#L33 A single number indicating the estimated ...
man/get_thresh_simstat.Rd#L36 Compute genome-wide significance (test s ...
man/get_thresh_simstat.Rd#L37 mapping by simulating admixture mapping  ...
man/get_thresh_simstat.Rd#L43 get_thresh_simstat(g = 6, map = example_ ...
man/nu.Rd#L16 Helper function for Ornstein Uhlenbeck a ...
man/run_unc_nls.Rd#L10 \item{lacorr}{local ancestry correlation ...
man/simstat_once.Rd#L14 \item{as}{vector of scalars (length m) b ...
man/simstat_once.Rd#L16 \item{bs}{vector of scalars (length m) b ...
man/simstat_once.Rd#L18 \item{L}{matrix (K x K-1) that is square ...
vignettes/STEAMcpp.Rmd#L26 The STEAM package (Significance Threshol ...
vignettes/STEAMcpp.Rmd#L28 When thinking about finding the genetic  ...
vignettes/STEAMcpp.Rmd#L30 Our goal is to find an appropriate signi ...
vignettes/STEAMcpp.Rmd#L34 The theoretical results implemented in t ...
vignettes/STEAMcpp.Rmd#L36 Grinde, K., Brown, L., Reiner, A., Thorn ...
vignettes/STEAMcpp.Rmd#L40 In Grinde et. al (2019), two approaches  ...
vignettes/STEAMcpp.Rmd#L42 - **Analytic Approximation**: applicable ...
vignettes/STEAMcpp.Rmd#L43 - **Test Statistic Simulation**: applica ...
vignettes/STEAMcpp.Rmd#L47 1. Create a `map` file containing, at mi ...
vignettes/STEAMcpp.Rmd#L48     * NOTE: If you inferred local ancest ...
vignettes/STEAMcpp.Rmd#L50 2. Estimate the admixture proportions fo ...
vignettes/STEAMcpp.Rmd#L51     * There are various ways to calculat ...
vignettes/STEAMcpp.Rmd#L54     * We recommend that you use STEAM fo ...
vignettes/STEAMcpp.Rmd#L58 For this example with 2 ancestral origin ...
vignettes/STEAMcpp.Rmd#L60 Step 1: Suppose we have markers spaced e ...
vignettes/STEAMcpp.Rmd#L69 Bonferroni, C. (1936). Teoria statistica ...
vignettes/STEAMcpp.Rmd#L71 Jannot, A. S., Ehret, G., & Perneger, T. ...
* NOTE: Consider multiples of 4 spaces for line indents; 273 lines (19%) are not.
First few lines:
R/combine_corr_chr.R#L21   # combine into single data table ...
R/combine_corr_chr.R#L22   snps.df <- rbindlist(cor.list) ...
R/combine_corr_chr.R#L24   # get average within each bin ...
R/combine_corr_chr.R#L25   avgs <- snps.df[,list(mean(corr_11),me ...
R/combine_corr_chr.R#L26   avgs[,('theta') := L_to_theta(bin)] #  ...
R/combine_corr_chr.R#L28   # add col names ...
R/combine_corr_chr.R#L29   names(avgs) <- c('cM', ...
R/combine_corr_chr.R#L30                    'corr_11','corr_12',' ...
R/combine_corr_chr.R#L31                    'corr_21','corr_22',' ...
R/combine_corr_chr.R#L32                    'corr_31','corr_32',' ...
R/combine_corr_chr.R#L33                    'theta') ...
R/combine_corr_chr.R#L35   # convert from wide to long ...
R/combine_corr_chr.R#L36   avgs.long <- reshape(avgs, direction = ...
R/combine_corr_chr.R#L37                        v.names = 'corr', ...
R/combine_corr_chr.R#L38                        times = c('1_1',' ...
R/combine_corr_chr.R#L40   avgs.long$anc2 <- avgs.long$anc ...
R/combine_corr_chr.R#L41   avgs.long$anc2[avgs.long$anc2=='2_1']  ...
R/combine_corr_chr.R#L42   avgs.long$anc2[avgs.long$anc2=='3_1']  ...
R/combine_corr_chr.R#L43   avgs.long$anc2[avgs.long$anc2=='3_2']  ...
R/combine_corr_chr.R#L45   # save final results as data frame ...
R/combine_corr_chr.R#L46   lacorr.df <- as.data.frame(avgs.long) ...
R/combine_corr_chr.R#L47   lacorr.df <- lacorr.df[,c('theta','cor ...
R/combine_corr_chr.R#L48   names(lacorr.df) <- c('theta','corr',' ...
R/combine_corr_chr.R#L49   return(lacorr.df) ...
R/exp_corr.R#L21   # restrict to desired components ...
R/exp_corr.R#L22   props <- props[,c(k1,k2)] ...
R/exp_corr.R#L23   # estimate E() and Cov() of admixture  ...
R/exp_corr.R#L24   E_pi <- apply(props, 2, mean) ...
R/exp_corr.R#L25   Cov_pi <- cov(props) ...
R/exp_corr.R#L26   C_pi <- Cov_pi[1,2] ...
R/exp_corr.R#L27   V_pi <- diag(Cov_pi) ...
R/exp_corr.R#L28   # calculate numerator ...
R/exp_corr.R#L29   num <- ((1-theta)^g)*(C_pi - prod(E_pi ...
R/exp_corr.R#L31   # calculate denominator ...
R/exp_corr.R#L32   denom <- prod(sqrt(E_pi-E_pi^2+V_pi)) ...
R/exp_corr.R#L33   # return expected correlation ...
R/exp_corr.R#L34   return(num/denom) ...
R/get_ab.R#L11   ## calculate a_{i,j}, b_{i,j} from del ...
R/get_ab.R#L12   beta <- 0.01*g ...
R/get_ab.R#L13   a <- exp(-beta*deltas) ...
R/get_ab.R#L14   b <- sqrt(1-exp(-2*beta*deltas)) ...
R/get_ab.R#L15   return(list(a=a,b=b)) ...
R/get_corr_chr.R#L28   ## restrict map to chrom of interest ...
R/get_corr_chr.R#L29   map.df <- subset(map, chr == chrom) ...
R/get_corr_chr.R#L31   # list all possible pairs of loci ...
R/get_corr_chr.R#L32   if(is.null(map.df$snp.id)) map.df$snp. ...
R/get_corr_chr.R#L33   snps.pairs <- combn(map.df$snp.id, 2) ...
R/get_corr_chr.R#L35   # store as data table ...
R/get_corr_chr.R#L36   snps.dt <- data.table(t(snps.pairs)) ...
R/get_corr_chr.R#L37   names(snps.dt) <- c('snp1','snp2') ...
R/get_corr_chr.R#L39   # add distances between pairs of SNPs ...
R/get_corr_chr.R#L40   snps.dt[, cM := get_dist(snp1,snp2,map ...
R/get_corr_chr.R#L41   snps.dt[, theta := L_to_theta(cM)] # r ...
R/get_corr_chr.R#L43   # figure out which distance bin each p ...
R/get_corr_chr.R#L44   snps.dt[, bin := round(cM/binsize, 0)  ...
R/get_corr_chr.R#L46   # keep 20 random pairs of SNPs per bin ...
R/get_corr_chr.R#L47   snps.dt[, pair := paste0(snp1,'_',snp2 ...
R/get_corr_chr.R#L48   selected <- snps.dt[, list(sample(pair ...
R/get_corr_chr.R#L49                       by = list(bin)] ...
R/get_corr_chr.R#L50   snps.dt <- snps.dt[pair %in% selected$ ...
R/get_corr_chr.R#L51   snps.dt$pair <- NULL # remove pair inf ...
R/get_corr_chr.R#L53   ## open GDS files ...
R/get_corr_chr.R#L54   pop1 <- seqOpen(pop1.gds) ...
R/get_corr_chr.R#L55   pop2 <- seqOpen(pop2.gds) ...
R/get_corr_chr.R#L56   pop3 <- seqOpen(pop3.gds) ...
R/get_corr_chr.R#L58   # set up correlation columns to store  ...
R/get_corr_chr.R#L59   snps.dt$corr_11 <- NA ...
R/get_corr_chr.R#L60   snps.dt$corr_12 <- NA ...
R/get_corr_chr.R#L61   snps.dt$corr_13 <- NA ...
R/get_corr_chr.R#L62   snps.dt$corr_21 <- NA ...
R/get_corr_chr.R#L63   snps.dt$corr_22 <- NA ...
R/get_corr_chr.R#L64   snps.dt$corr_23 <- NA ...
R/get_corr_chr.R#L65   snps.dt$corr_31 <- NA ...
R/get_corr_chr.R#L66   snps.dt$corr_32 <- NA ...
R/get_corr_chr.R#L67   snps.dt$corr_33 <- NA ...
R/get_corr_chr.R#L69   # loop through pairs to get correlatio ...
R/get_corr_chr.R#L70   for(i in 1:nrow(snps.dt)){ ...
R/get_corr_chr.R#L87   } ...
R/get_corr_chr.R#L89   # close gds files ...
R/get_corr_chr.R#L90   seqClose(pop1); seqClose(pop2); seqClo ...
R/get_corr_chr.R#L92   # return data table with correlation ...
R/get_corr_chr.R#L93   return(snps.dt) ...
R/get_deltas.R#L10   # check for missing values ...
R/get_deltas.R#L11   if(sum(is.na(map$cM))>0) stop('Missing ...
R/get_deltas.R#L12   if(sum(is.na(map$chr))>0) stop('Missin ...
R/get_deltas.R#L14   # initial distance between adjacent ma ...
R/get_deltas.R#L15   deltas <- diff(map$cM) ...
R/get_deltas.R#L17   # set distance between chromosomes to  ...
R/get_deltas.R#L18   chr_starts <- sapply(1:22, function(x) ...
R/get_deltas.R#L19   deltas[chr_starts-1] <- 100000 ...
R/get_deltas.R#L21   # return deltas ...
R/get_deltas.R#L22   return(deltas) ...
R/get_g.R#L31       a1 <- anc.pairs[i,1]; a2 <- anc.pa ...
R/get_g.R#L32       ab[[i]] <- coef(run_unc_nls(lacorr ...
R/get_g.R#L41                                   "nls(c ...
R/get_g.R#L42                                   'start ...
R/get_L.R#L10   # number of ancestral pops ...
R/get_L.R#L11   K <- length(ep) ...
R/get_L.R#L12   # get correlation matrix ...
R/get_L.R#L13   sig <- get_sigma(ep=ep) ...
R/get_L.R#L14   # get square root ...
R/get_L.R#L15   if(K==2){ ...
R/get_L.R#L18   } else if(K==3){ ...
R/get_L.R#L21                   sig[1,2],sqrt(1-sig[1, ...
R/get_L.R#L22                   sig[1,3],-sqrt(1-sig[1 ...
R/get_L.R#L24   } else{ ...
R/get_L.R#L27       # mroot ...
R/get_L.R#L28       L <- mgcv::mroot(sig,rank=K-1,meth ...
R/get_L.R#L30       L <- NULL ...
R/get_L.R#L31       cat('Please install package \"mgcv ...
R/get_L.R#L33   } ...
R/get_L.R#L34   return(L) ...
R/get_sigma_ij.R#L11   -ep1*ep2/sqrt(ep1*(1-ep1)*ep2*(1-ep2)) ...
R/get_sigma.R#L11   # get offdiagonal elements ...
R/get_sigma.R#L12   sigma <- outer(ep,ep,get_sigma_ij) ...
R/get_sigma.R#L13   # replace diagonal elements with 1 ...
R/get_sigma.R#L14   diag(sigma) <- 1 ...
R/get_sigma.R#L15   # return correlation matrix ...
R/get_sigma.R#L16   return(sigma) ...
R/get_thresh_analytic.R#L26   # calculate number of chromosomes ...
R/get_thresh_analytic.R#L27   nchr <- length(unique(map$chr)) ...
R/get_thresh_analytic.R#L28   # calculate distances between consecut ...
R/get_thresh_analytic.R#L29   delt.list <- lapply(1:nchr, function(x ...
R/get_thresh_analytic.R#L30   # calculate marker density (average) a ...
R/get_thresh_analytic.R#L31   delt <- mean(unlist(delt.list)) ...
R/get_thresh_analytic.R#L32   L <- sum(unlist(delt.list)) ...
R/get_thresh_analytic.R#L33   # get test stat threshold ...
R/get_thresh_analytic.R#L34   Z <- uniroot(OU_approx, interval = sea ...
R/get_thresh_analytic.R#L35   # if type = 'pval', return pval instea ...
R/get_thresh_analytic.R#L36   if(type=='pval'){ ...
R/get_thresh_analytic.R#L39   } else if(type=='stat'){ ...
R/get_thresh_analytic.R#L41   } else{ ...
R/get_thresh_analytic.R#L43   } ...
R/get_thresh_simstat.R#L27   # get distances between adjacent marke ...
R/get_thresh_simstat.R#L28   dlt <- c(0,get_deltas(map)) # length m ...
R/get_thresh_simstat.R#L30   # pre-calculate constants for test sta ...
R/get_thresh_simstat.R#L31   ab <- get_ab(dlt,g) ...
R/get_thresh_simstat.R#L33   # get average admixture proportions ...
R/get_thresh_simstat.R#L34   avg_props <- apply(props,2,mean,na.rm= ...
R/get_thresh_simstat.R#L36   # calculate the matrix L ...
R/get_thresh_simstat.R#L37   L <- get_L(avg_props) # could condense ...
R/get_thresh_simstat.R#L39   # simulate test stats nreps times ...
R/get_thresh_simstat.R#L40   if (method == "cpp"){ ...
R/get_thresh_simstat.R#L42   } else { ...
R/get_thresh_simstat.R#L44   } ...
R/get_thresh_simstat.R#L46   # get upper alpha quantile ...
R/get_thresh_simstat.R#L47   zstar <- upper_alpha(max_stats, alpha) ...
R/get_thresh_simstat.R#L49   # get 95% bootstrap CI for threshold ( ...
R/get_thresh_simstat.R#L50   if (requireNamespace("bootstrap", quie ...
R/get_thresh_simstat.R#L52   } else{ ...
R/get_thresh_simstat.R#L55   } ...
R/get_thresh_simstat.R#L57   # return threshold ...
R/get_thresh_simstat.R#L58   if(type == "stat"){ ...
R/get_thresh_simstat.R#L61   } else if(type == "pval"){ ...
R/get_thresh_simstat.R#L64   } else{ ...
R/get_thresh_simstat.R#L66   } ...
R/get_thresh_simstat.R#L67   return(list(threshold = thresh, ci = t ...
R/globals.R#L2                          "corr_23","corr ...
R/globals.R#L3                          ,"snp1","snp2", ...
R/helper_functions.R#L3   objname <- load(Rdata) ...
R/helper_functions.R#L4   if (length(objname) > 1) { ...
R/helper_functions.R#L6                   "\nReturning only the  ...
R/helper_functions.R#L7   } ...
R/helper_functions.R#L8   return(get(objname)) ...
R/helper_functions.R#L13   L <- cM/100 ...
R/helper_functions.R#L14   theta <- 0.5*(1-exp(-2*L)) ...
R/helper_functions.R#L15   return(theta) ...
R/helper_functions.R#L20   pos1 <- gen.map$cM[match(s1, gen.map$s ...
R/helper_functions.R#L21   pos2 <- gen.map$cM[match(s2, gen.map$s ...
R/helper_functions.R#L22   return(abs(pos2-pos1)) ...
R/helper_functions.R#L27   # load ancestries at SNPs s1 and s2 ...
R/helper_functions.R#L28   afr.anc <- snpgdsGetGeno(afr, snp.id = ...
R/helper_functions.R#L29   eur.anc <- snpgdsGetGeno(eur, snp.id = ...
R/helper_functions.R#L30   nam.anc <- snpgdsGetGeno(nam, snp.id = ...
R/helper_functions.R#L31   # get indices for each SNP (make sure  ...
R/helper_functions.R#L32   e1 <- which(eur.anc$snp.id==s1); e2 <- ...
R/helper_functions.R#L33   a1 <- which(afr.anc$snp.id==s1); a2 <- ...
R/helper_functions.R#L34   n1 <- which(nam.anc$snp.id==s1); n2 <- ...
R/helper_functions.R#L35   # get correlation between all possible ...
R/helper_functions.R#L36   c11 <- cor(afr.anc$g[,a1], afr.anc$g[, ...
R/helper_functions.R#L37   c12 <- cor(afr.anc$g[,a1], eur.anc$g[, ...
R/helper_functions.R#L38   c13 <- cor(afr.anc$g[,a1], nam.anc$g[, ...
R/helper_functions.R#L39   c21 <- cor(eur.anc$g[,e1], afr.anc$g[, ...
R/helper_functions.R#L40   c22 <- cor(eur.anc$g[,e1], eur.anc$g[, ...
R/helper_functions.R#L41   c23 <- cor(eur.anc$g[,e1], nam.anc$g[, ...
R/helper_functions.R#L42   c31 <- cor(nam.anc$g[,n1], afr.anc$g[, ...
R/helper_functions.R#L43   c32 <- cor(nam.anc$g[,n1], eur.anc$g[, ...
R/helper_functions.R#L44   c33 <- cor(nam.anc$g[,n1], nam.anc$g[, ...
R/helper_functions.R#L45   return(c(c11,c12,c13,c21,c22,c23,c31,c ...
R/nu.R#L12   y <- x/2 ...
R/nu.R#L13   (1/y)*(pnorm(y)-0.5)/(y*pnorm(y)+dnorm ...
R/OU_approx.R#L25   # code courtesy of Siegmund and Yakir  ...
R/OU_approx.R#L26   d <- switch(test,"two-sided"=2,"one-si ...
R/OU_approx.R#L27   p <- 1-exp(-d*chr*(1-pnorm(z)) ...
R/OU_approx.R#L28              -d*beta*length*z*dnorm(z)*n ...
R/OU_approx.R#L29   return(p-center) ...
R/run_unc_nls.R#L23   # get name of ancestry pair ...
R/run_unc_nls.R#L24   a.pair <- paste(sort(c(k1,k2),decreasi ...
R/run_unc_nls.R#L25   # run NLS ...
R/run_unc_nls.R#L26   mod <- eval(parse(text=paste0("with(su ...
R/run_unc_nls.R#L32   # return model ...
R/run_unc_nls.R#L33   return(mod) ...
R/simstat_once.R#L22   # initialize max ...
R/simstat_once.R#L23   Zmax <- 0 ...
R/simstat_once.R#L25   # generate all random normals that we' ...
R/simstat_once.R#L26   norms <- rnorm(m*(K-1),0,1) ...
R/simstat_once.R#L28   # generate indices for grabbing normal ...
R/simstat_once.R#L29   starts <- seq(from=1, to=(K-1)*m, by=K ...
R/simstat_once.R#L30   ends <- seq(from=K-1, to=(K-1)*m, by=K ...
R/simstat_once.R#L32   # get stats at first marker ...
R/simstat_once.R#L33   Zlast <- L %*% norms[(starts[1]):(ends ...
R/simstat_once.R#L35   # loop through remaining markers ...
R/simstat_once.R#L36   for(i in 2:m){ ...
R/simstat_once.R#L39       bs[i] * L %*% norms[(starts[i]):(e ...
R/simstat_once.R#L44   } ...
R/simstat_once.R#L46   # return max ...
R/simstat_once.R#L47   return(Zmax) ...
R/upper_alpha.R#L11   ## Get upper alpha percentile ...
R/upper_alpha.R#L12   quantile(t,prob=1-alpha) ...
man/example_ab.Rd#L8   Each element contains a vector of leng ...
man/example_ab.Rd#L9   (m = no. markers). ...
man/example_ab.Rd#L13   \code{example_ab <- get_ab(get_deltas( ...
man/example_corr_K3.Rd#L8   The theta column contains recombinatio ...
man/example_corr_K3.Rd#L9   The corr column contains correlation i ...
man/example_corr_K3.Rd#L10   The anc column indicated which ancestr ...
man/example_corr_K3.Rd#L11   compared (e.g., '1_1', '1_2', '2_3').  ...
man/example_corr_K3.Rd#L15   \code{thetas <- seq(0, 0.5, length = 5 ...
man/example_corr.Rd#L8   The theta column contains recombinatio ...
man/example_corr.Rd#L9   The corr column contains correlation i ...
man/example_corr.Rd#L10   The anc column indicated which ancestr ...
man/example_corr.Rd#L11   compared (e.g., '1_1', '1_2'). Number  ...
man/example_corr.Rd#L15   \code{thetas <- seq(0, 0.5, length = 5 ...
man/example_L.Rd#L8   and K-1 columns. ...
man/example_L.Rd#L12   \code{get_L(apply(example_props,2,mean ...
man/example_map.Rd#L8   as many columns as desired, but at min ...
man/example_map.Rd#L9   two columns named 'cM' and 'chr' which ...
man/example_map.Rd#L10   positions (in centimorgans) and chromo ...
man/example_map.Rd#L11   for each marker. ...
man/example_map.Rd#L15   \code{data.frame(cM = rep(seq(0.2, 160 ...
man/example_props_K3.Rd#L8   and K columns (K = no. ancestral popul ...
man/example_props_K3.Rd#L9   contains estimated proportion of total ...
man/example_props_K3.Rd#L10   inherited from that ancestral populati ...
man/example_props_K3.Rd#L11   not matter. ...
man/example_props_K3.Rd#L15   \code{library(gtools); example_props_K ...
man/example_props.Rd#L8   and K columns (K = no. ancestral popul ...
man/example_props.Rd#L9   contains estimated proportion of total ...
man/example_props.Rd#L10   inherited from that ancestral populati ...
man/example_props.Rd#L11   not matter. ...
man/example_props.Rd#L15   \code{example_props <- data.frame(pop1 ...
man/get_corr_chr.Rd#L8   chrom, ...
man/get_corr_chr.Rd#L9   binsize = 0.5, ...
man/get_corr_chr.Rd#L10   map, ...
man/get_corr_chr.Rd#L11   pop1.gds, ...
man/get_corr_chr.Rd#L12   pop2.gds, ...
man/get_corr_chr.Rd#L13   pop3.gds, ...
man/get_corr_chr.Rd#L14   verbose = TRUE ...
man/get_thresh_analytic.Rd#L8   g, ...
man/get_thresh_analytic.Rd#L9   map, ...
man/get_thresh_analytic.Rd#L10   alpha = 0.05, ...
man/get_thresh_analytic.Rd#L11   type = "pval", ...
man/get_thresh_analytic.Rd#L12   searchint = c(1.96, 8) ...
man/get_thresh_simstat.Rd#L8   g, ...
man/get_thresh_simstat.Rd#L9   map, ...
man/get_thresh_simstat.Rd#L10   props, ...
man/get_thresh_simstat.Rd#L11   nreps = 10000, ...
man/get_thresh_simstat.Rd#L12   alpha = 0.05, ...
man/get_thresh_simstat.Rd#L13   type = "pval", ...
man/get_thresh_simstat.Rd#L14   method = "cpp" ...
vignettes/STEAMcpp.Rmd#L15   collapse = TRUE, ...
vignettes/STEAMcpp.Rmd#L16   comment = "#>" ...
vignettes/STEAMcpp.Rmd#L49    ...
vignettes/STEAMcpp.Rmd#L52    ...
vignettes/STEAMcpp.Rmd#L55    ...
* Checking if package already exists in CRAN... OK
* Checking for bioc-devel mailing list subscription...
* NOTE: Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
* Checking for support site registration...
* ERROR: Unable to find your email in the Support Site:
  HTTP 404 Not Found.
